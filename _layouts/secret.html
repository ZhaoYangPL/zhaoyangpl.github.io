---
# 这是一个基础布局，继承了主题的默认样式
layout: page
---

<!DOCTYPE html>
<html>
<head>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <style>
    /* 这里是一些简单的样式，可以按需修改 */
    #secret-container { text-align: center; padding: 20px 0; }
    #secret-controls { margin-bottom: 20px; }
    #secret-content { text-align: left; background-color: #252526; border: 1px solid #333; padding: 20px 40px; border-radius: 8px; }
    #secret-container input { font-size: 1em; padding: 10px; border-radius: 5px; border: 1px solid #555; background-color: #3d3d3d; color: #fff; }
    #secret-container button { font-size: 1em; padding: 10px 20px; border-radius: 5px; border: none; background-color: #007acc; color: white; cursor: pointer; }
  </style>
</head>
<body>

  <div id="secret-container">
    <h2 id="page-title">Enter the code to visit</h2>
    <div id="secret-controls">
      <input type="password" id="password" placeholder="Please enter the code..." onkeypress="if(event.keyCode===13) decrypt()">
      <button onclick="decrypt()">Decode</button>
    </div>
    <div id="secret-content" style="display:none;"></div>
  </div>

  <script>
    // 这段特殊代码会自动抓取您文章文件里的加密文本
    var encryptedContent = {{ content | strip | jsonify }};

    function decrypt() {
      var password = document.getElementById('password').value;
      if (!password) { alert("Enter the code！"); return; }
      try {
        var decrypted = CryptoJS.AES.decrypt(encryptedContent, password);
        var plaintext = decrypted.toString(CryptoJS.enc.Utf8);

        if (plaintext) {
          document.getElementById('secret-content').innerHTML = marked.parse(plaintext);
          document.getElementById('secret-content').style.display = 'block';
          document.getElementById('secret-controls').style.display = 'none';
          document.getElementById('page-title').innerText = "{{ page.title }}";
        } else { throw new Error('Decryption failed'); }
      } catch (e) {
        alert("Wrong code！");
        document.getElementById('password').value = '';
      }
    }
  </script>

</body>
</html>